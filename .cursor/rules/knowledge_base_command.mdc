# 知识库命令处理

## 触发条件
当用户输入以下命令时，自动触发知识库生成:
- `/kb`
- `/知识库`
- `/knowledge`
- `/KB`

## 规则描述
本规则定义了一个通用机制，允许在任何角色对话中快速将有价值的对话内容整理成结构化知识库文档，方便后续查阅和分享。

## 命令格式
- `/kb` - 基础知识库生成命令（生成标准知识库）
- `/kb simple` - 生成简化版知识库（仅关键要点）
- `/kb full` - 生成完整知识库（详细解释+代码+案例）
- `/kb topic [主题名称]` - 指定主题的知识库

## 处理流程

### 1. 会话分析
1. 检测当前活跃角色（pm/ar/dv/qa/co/sre/ex等）
2. 提取会话中的关键信息、主题和核心概念
3. 识别代码片段、重要决策和解决方案
4. 识别常见问题和解答部分

### 2. 确认阶段
1. 向用户呈现拟创建的知识库主题和大纲
2. 提供知识库分类和命名建议
3. 征求用户确认或调整建议
4. 确认知识库存储位置（默认为docs/knowledge-base/）

### 3. 生成阶段
1. 创建知识库目录结构（若不存在）
2. 按照角色匹配的模板生成主文档（.md格式）
3. 根据需要生成示例文档和常见问题文档
4. 更新或创建README.md索引文件

### 4. 完成通知
1. 报告知识库创建完成状态
2. 提供文件路径和简要内容概述
3. 建议后续扩展和完善方向

## 文档结构

### 目录结构
```
docs/
└── knowledge-base/
    ├── README.md                      # 知识库索引
    ├── [角色代码]-[主题]-guide.md       # 主指南文档
    ├── [角色代码]-[主题]-examples.md    # 实例文档(可选)
    └── [角色代码]-[主题]-faq.md         # 常见问题(可选)
```

### 角色特定模板

1. **SRE角色模板** (系统运维专家)
   - 环境配置与系统要求
   - 详细的安装与配置步骤
   - 故障排除与诊断指南
   - 性能优化建议
   - 安全与备份最佳实践
   - 常见操作命令示例

2. **DV角色模板** (开发工程师)
   - 代码实现详解
   - API设计与使用说明
   - 数据结构与算法解析
   - 测试与调试方法
   - 开发环境配置
   - 代码示例与最佳实践

3. **AR角色模板** (架构师)
   - 系统架构概述
   - 技术选型与评估
   - 组件交互设计
   - 扩展性与性能考量
   - 设计决策与权衡
   - 架构演进路线图

4. **PM角色模板** (产品经理)
   - 需求背景与分析
   - 功能规格说明
   - 用户场景与流程
   - 产品设计决策
   - 用户体验考量
   - 功能优先级与路线图

5. **QA角色模板** (测试工程师)
   - 测试策略与计划
   - 测试用例设计
   - 自动化测试方法
   - 缺陷管理流程
   - 测试环境配置
   - 性能与安全测试指南

6. **CO角色模板** (项目教练)
   - 项目管理方法论
   - 团队协作指南
   - 风险管理策略
   - 进度跟踪与报告
   - 资源分配建议
   - 项目复盘与经验总结

7. **EX角色模板** (探索者)
   - 创新思路与方法
   - 机制设计与评估
   - 实验方案与结果
   - 改进建议与方向
   - 系统思考分析
   - 协作模式优化

## 响应示例

当用户输入`/kb`命令时，响应示例：

```
我将帮您将本次对话整理成知识库文档。

根据对话内容，我提取的主题是：[主题名称]
建议的知识库结构如下：

## 主要文档：[主题]-guide.md
- [章节1]
- [章节2]
- [章节3]

## 示例文档：[主题]-examples.md（可选）
- [示例类别1]
- [示例类别2]

## 常见问题：[主题]-faq.md（可选）
- [问题1]
- [问题2]

您是否同意这个规划？如需调整，请告知。
如果同意，我将立即开始生成知识库文档。
```

## 注意事项
1. 确保提取的内容准确反映对话的核心价值
2. 保持知识库结构清晰、层次分明
3. 保留代码示例和重要命令的完整性
4. 适当添加元数据（如创建日期、更新记录等）
5. 避免包含敏感信息或个人隐私数据

## 更新机制
如果知识库主题已存在，提供以下选项：
1. 创建新版本（附加版本号）
2. 合并更新现有文档
3. 替换现有文档

## 附加功能
- 支持将知识库导出为PDF格式（未来扩展）
- 支持引用其他知识库文档（未来扩展）
- 支持知识库标签和分类系统（未来扩展） 